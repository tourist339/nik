
<form id="setup-container"  method="post" action="/host/add_temp_property" enctype="multipart/form-data">

    <div id="setup-box" >
        <!--        A wrapper to put everything in middle-->
        <div  id="setup-box-content" style="justify-content:center;">

            <!--        First page box For props information-->
            <div class="setup-fader activePhase" id="phase1" >
                <h1 class="midsize">Property's information</h1>
                <div class="gridbox setup-gridbox">
                    <div class="input-item">
                        <label for="pType">Property Type</label>
                        <select   name="pType" id="pType">
                            <option value="" disabled selected>Choose </option>
                            <option value="Apartment">Apartment</option>
                            <option  value="House">House</option>
                            <option  value="Floor">Floor</option>
                            <option  value="Office Space">Office Space</option>

                        </select>

                    </div>

                    <div class="input-item">
                    <label for="pSharingType">Sharing Type</label>
                    <select    name="pSharingType" id="pSharingType">
                        <option value="" disabled selected>Select your option </option>
                        <option  value="Entire Place">Entire Place</option>
                            <option value="Private Room">Private Room</option>
                            <option value="Shared Room">Shared Room</option>
                    </select>
                    </div>

                    <div class="input-item">
                    <label for="pNoGuests" >No. Of Guests</label>
                    <input type=number class="required-input numinp" min="0" max="12" placeholder="" name="pNoGuests" id="pNoGuests" >
                    </div>



                <div class="input-item ">
                    <label for="pNoBeds" >No. Of Bedrooms:</label>
                    <input type=number class="numinp required-input" min="0" max="8" name="pNoBeds" id="" >
                </div>

                <div class="input-item">
                    <label for="pNoBathrooms">No. Of Bathrooms:</label>
                    <input type=number class="numinp required-input" min="0" max="6" name="pNoBathrooms"  id="pNoBathrooms" >
                </div>


                <div class="input-item">
                    <label for="pKitchenAvailables">Is kitchen available?</label>
                    <select  class="numinp required-input"  name="pKitchenAvailable" id="pKitchenAvailable">
                        <option value="1">Yes</option>
                        <option selected value="0">No</option>
                    </select>
                </div>
                </div>
            </div>

            <!--        Second page box-->
            <div class="setup-fader" id="phase2" >
                <textarea id="ta-title"rows="2" maxlength="50" name="pTitle" class="required-input" placeholder="Title"></textarea>
                <textarea id="ta-desc"  maxlength="2000" name="pDesc" class="required-input" placeholder="Description"></textarea>

            </div>


            <!--        Third Page box (MAP)-->
            <div class="setup-fader nomap" id="phase3" >
                <h1 class="midsize">Property Address</h1>
                <button type="button" id="getLocation">Use current location </button>

                <input type=text placeholder="Street Address" class="required-input" name="pAddress" id="prop-straddr"" />
                <input type=text placeholder="Apt. Number (Optional)" name="pApt" id="prop-aptno">

                <div class="rowflex">
                    <input type=text placeholder="City" class="required-input" name="pCity" id="prop-city">
                    <input type=text placeholder="State" class="required-input" name="pState" id="prop-state">
                </div>
                <p class="phase-text" style="display:none;">You can adjust the marker</p>
                <div id="map"></div>

            </div>


            <!--        Fourth Page box (AMENITIES)-->
            <div class="setup-fader" id="phase4" >
                <h1 class="midsize" style="margin-bottom:0vw;text-align:start;">What amenities do you offer?</h1>
                <p class="phase-text" >You can select from the list or add your own</p>
                <!--            Items are loaded via javascript-->
                <div id="amenity-box"></div>
                <div class="rowflex">
                    <input type=text autocomplete='nope' placeholder="Pool?" name="" id="prop-add-amenity">
                    <input type="button" value="Add" id="add-amenity">
                </div>
            </div>


            <!--        FIfth Page box (HOUSE RULES AND GENDER)-->
            <div class="setup-fader" id="phase5" >
                <h1 class="midsize" style="text-align:start;">Setup house rules</h1>
                <div id="hrules-box" rules="3">
                    <div class="rowflex">
                        <p class="phase-text">Smoking Allowed</p>
                        <input type="button" class="rules-btns rb1" value="&#10003;" style="margin-left:auto;margin-right:1vw;">
                        <input type="button" class="rules-btns rb1" value="X">

                        <input type="hidden" class="rules-yes"  value="Smoking Allowed:Yes">
                        <input type="hidden" class="rules-no"  value="Smoking Allowed:Noo">

                    </div>
                    <div class="rowflex">
                        <p class="phase-text">Parties allowed</p>
                        <input type="button" class="rules-btns rb2" value="&#10003;" style="margin-left:auto;margin-right:1vw;">
                        <input type="button" class="rules-btns rb2" value="X">
                        <input type="hidden" class="rules-yes"  value="Parties Allowed:Yes">
                        <input type="hidden" class="rules-no"  value="Parties Allowed:Noo">
                    </div>
                    <div class="rowflex">
                        <p class="phase-text">Pet Friendly</p>
                        <input type="button" class="rules-btns rb3" value="&#10003;" style="margin-left:auto;margin-right:1vw;">
                        <input type="button" class="rules-btns rb3" value="X">
                        <input type="hidden" class="rules-yes"  value="Pet Friendly:Yes">
                        <input type="hidden" class="rules-no"  value="Pet Friendly:Noo">
                    </div>
                </div>
                <div>
                <p class="phase-text-label">Additional Rules</p>
                <div class="rowflex" class="notopmargin">
                    <input type=text autocomplete="nope" placeholder="Setup Queit hours? " style="max-width:100%;flex:1 1 auto;"  class="notopmargin" id="house-rules-new">
                    <input type="button" value="Add" class="notopmargin" id="add-house-rules">
                </div>
                </div>

                <div >
                    <p class="phase-text-label">Gender Allowed</p>
                    <select  class="notopmargin required-input"  name="pGender" id="pGender">
                        <option value="" disabled selected>Choose </option>
                        <option value="males">Only Male</option>
                        <option  value="females">Only Female</option>
                        <option  value="Both">Both</option>

                    </select>
                </div>


            </div>

            <!--            Sixth PAGE BOX (lyfly and rent)-->
            <div class="setup-fader" id="phase6">
                <h1 class="midsize" >Property Management</h1>
                <div class="label-input">
                <p>Do you want lyfly to manage the property?</p>
                <select  class="required-input"  name="pLyfly" id="pLyfly">
                    <option value="" disabled selected>Choose </option>
                    <option value="1">Yes</option>
                    <option  value="0">No</option>
                </select>
                </div>
                <div class="toggleVisible" visible="false" id="not-lyfly">
                <input type=text placeholder="Rent in Rs." style="width:16vw;" name="pRent" id="prop-rent" />
                <p class="phase-text" style="font-size:1.6vw;">What does the rent include?</p>
                <div>
                    <input type="checkbox" value="Electricity" class="rent-utils" id="electricity">
                    <label for="electricity" class="phase-text">Electricity</label>
                </div>
                <div>
                    <input type="checkbox" value="Water" class="rent-utils" id="water">
                    <label for="water" class="phase-text">Water</label>
                </div>
                <h1 class="midsize" style="text-align:start;margin-top:1vw;">Upload images of the property</h1>
                <input type="file" id="imgInp" name="images[]" accept="image/* " class="notopmargin" multiple><br><br>


                    <div class="rowflex" id="agr-div">
                        <p class="phase-text-inline" >Agreement Type</p>
                        <select id="agreement-type" name="pAgreement">
                            <option value="" selected disabled>Choose</option>
                            <option value="monthly">Monthly</option>
                            <option value="halfyear">6 months</option>
                            <option value="yearly">1 year</option>
                            <option value="custom">Custom</option>
                        </select>
                        <input type=text  style='max-width:10vw' id="custom-agrtype" placeholder='2 months?' class="hidden">

                    </div>
                </div>
            </div>

        </div>


        <!--      Footer div containing next and page switch buttons  -->
        <div class="rowflex setup-footer">
            <input type="button" for="phase1" class="switch-btns activeBtn" value="" id="p1-switch"></input>
            <input type="button" for="phase2" class="switch-btns hidden" value="" id="p2-switch">
            <input type="button" for="phase3" class="switch-btns hidden" value="" id="p3-switch">
            <input type="button" for="phase4" class="switch-btns hidden" value="" id="p4-switch">
            <input type="button" for="phase5" class="switch-btns hidden" value="" id="p5-switch">
            <input type="button" for="phase6" class="switch-btns hidden" value="" id="p6-switch">
            <input type="button" for="phase7" class="switch-btns hidden" value="" id="p7-switch">

            <input type="button" value="Next" class="" id="setup-box-next">

        </div>
    </div>
    <div id="image-preview-box">
    </div>

    </div>
</form>


</body>

<!--    Map loading scripts-->
<script type="text/javascript" src="//maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&key=AIzaSyDTWvYehAfHTElUe6NyRq0KVAuZVoI4RQM&ver=3.exp"></script>
<script>
    var x = document.getElementById("demo");
    function getLocation() {
        $(".activePhase").removeClass("nomap");
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
            $("#setup-box-next").prop("disabled",true);
        } else {
            $("#map").innerHTML = "Geolocation is not supported by this browser.";
        }
    }



    function showPosition(position) {
//    get latitute and longitude


        var lat= position.coords.latitude ;
        var lng= position.coords.longitude;
        latitude=lat;
        longitude=lng;

        var google_map_position = new google.maps.LatLng( lat, lng );
        var google_maps_geocoder = new google.maps.Geocoder();
        google_maps_geocoder.geocode(
            { 'latLng': google_map_position},
            function( results, status ) {
//        results contain all the address related info
                var k=results[0].address_components;
                $("#prop-straddr").val(k[0].long_name+" "+ k[1].long_name);
                $("#prop-city").val( k[3].long_name);
                $("#prop-state").val( k[5].long_name);
                initMap(lat,lng);
            }
        );

    }

    function initMap(latitude,longitude) {
        $("#map").css("display","block");
        $(".phase-text").css("display","block");
//            Scroll to map bottom
        $("#setup-box-content").animate({ scrollTop: $('#setup-box-content').prop("scrollHeight")}, 1500);
        // The location of Uluru
        var uluru = {lat: latitude, lng: longitude};
        // The map, centered at Uluru
        var map = new google.maps.Map(
            document.getElementById('map'), {zoom: 18,
                center: uluru});
        // The marker, positioned at Uluru
        var marker = new google.maps.Marker({position: uluru,
            draggable:true,
            animation:google.maps.Animation.DROP,
            map: map});
        google.maps.event.addListener(marker, 'dragend', function(evt){
            document.getElementById('current').innerHTML = '<p>Marker dropped: Current Lat: ' + evt.latLng.lat().toFixed(3) + ' Current Lng: ' + evt.latLng.lng().toFixed(3) + '</p>';
        });

        $("#setup-box-next").prop("disabled",false);
    }

    function displayMap(){
        var geocoder = new google.maps.Geocoder();
        var address = $("#prop-straddr").val()+" , "+$("#prop-city").val()+" , "+$("#prop-state").val();
        geocoder.geocode( { 'address': address}, function(results, status) {

            if (status == google.maps.GeocoderStatus.OK) {
                var latitude = results[0].geometry.location.lat();
                var longitude = results[0].geometry.location.lng();
                $("#setup-box-next").prop("disabled",true);

                initMap(latitude,longitude);

            }
        });
    }
</script>
<!--    Amenities loading script-->
<script>
    var  amList=lyfly.getAmenities();
    for (var amenity of amList){
        addAmenity(amenity);
    }
    function addAmenity(amenity){
        $("#amenity-box").append("<div class='amenity'>"+
            "<input type='checkbox'  id='"+amenity+"' name='amenities[]' value='"+amenity+"'>"+
            "<label for='"+amenity+"' class='phase-text'>"+amenity+"</label><br>"+
            "</div>");
    }
</script>

<script>

function  addHouseRules(houserule,newCount) {
$("#hrules-box").append("<div class=\"rowflex\">\n" +
    "                        <p class=\"phase-text\">"+houserule+"</p>\n" +
    "                        <input type=\"button\" class=\"rules-btns rb"+newCount+"\" value=\"&#10003;\" style=\"margin-left:auto;margin-right:1vw;\">\n" +
    "                        <input type=\"button\" class=\"rules-btns rb"+newCount+"\" value=\"X\">\n" +
    "                        <input type=\"hidden\" class=\"rules-yes\"  value=\""+houserule+":Yes\">\n" +
    "                        <input type=\"hidden\" class=\"rules-no\"  value=\""+houserule+":Noo\">\n" +
    "                    </div>");
}
</script>

<!--    Main event functions script-->
<script>
    AOS.init();

    // checking validity dynamically
    <?php if(SETUP_DEBUG_MODE): ?>
    $(".required-input").prop("required",true);
    <?php endif; ?>
    $("#getLocation").click(function(){
        getLocation();
    });



    // Add Amenity button event
    $("#add-amenity").on("click",function () {
        var amenity=$("#prop-add-amenity").val();
        addAmenity(amenity);
        $("#prop-add-amenity").val("");

    });

    //        House rules button event
    $("#hrules-box").on("click",".rules-btns",function(){
        var value=$(this).val();
        if($(this).hasClass("activeBtn")){
            $(this).removeClass("activeBtn");
            if(value=="X"){
                $(this).siblings(".rules-no").removeAttr("name");
            }else{
                $(this).siblings(".rules-yes").removeAttr("name");
            }
        }else{
            var sClass=$(this).attr("class").split(' ')[1];
            $("."+sClass).removeClass("activeBtn");
            $(this).addClass("activeBtn");
            if(value=="X"){
                $(this).siblings(".rules-no").attr("name","hRules[]");
                $(this).siblings(".rules-yes").removeAttr("name");

            }else{
                $(this).siblings(".rules-yes").attr("name","hRules[]");
                $(this).siblings(".rules-no").removeAttr("name");

            }
        }
    });




    // Add House rules button event
    $("#add-house-rules").on("click",function () {
        var rule=$("#house-rules-new").val();
        $("#house-rules-new").val("");
        var newCount=parseInt($("#hrules-box").attr("rules")) +1;
        $("#hrules-box").attr("rules",newCount);
        console.log(newCount);
        addHouseRules(rule,newCount);
    });


    //lyfly option change event
    $("#pLyfly").on("change",function () {
        let isLyfly=$(this).val();
        if(isLyfly==0){
            $("#not-lyfly").attr("visible","true");
        }else{
            $("#not-lyfly").attr("visible","false");

        }
    });


    //form submit event
    $("#setup-container").submit(function(e){
        e.preventDefault();
        var form=$(this);
        var url=form.attr("action");
        var data=form.serializeArray();
        // var amenities=["ka","fdsafs","Fsd"];
        // data.push({name: 'amenities', value: amenities},{name: 'vw', value: amenities});

        var formData = new FormData(this);

        $.ajax({
            url: url,
            type: 'POST',
            data: formData,
            success: function (data) {
                $("#image-preview-box").append(data);
            },
            cache: false,
            contentType: false,
            processData: false
        });

    });


    //        Agreement dropdown change event
    $("#agreement-type").change(function(){
        if($(this).val()=="custom"){
            $("#custom-agrtype").removeClass("hidden");
        }else{
            if(!$("#custom-agrtype").hasClass("hidden")){
                $("#custom-agrtype").addClass("hidden");

            }
        }
    });


    //    Bottom next phase button event
    $("#setup-box-next").click(function() {
        var gonext=true;


            var k = $(".activePhase");
            var id = k.attr("id");
            $("#" + id + " .required-input").each(function () {
                if (!$(this)[0].checkValidity()) {
                 //   alert($(this).attr("name"));
                    gonext = false;
                    $(this).addClass("shakeinp");
                    //s$(this).focus();
                }
            });

            setTimeout(function () {
                $("#" + id + " .required-input").each(function () {
                    $(this).removeClass("shakeinp");

                });
            }, 500);

            if (gonext) {



                if (id == "phase3" && k.hasClass("nomap")) {
                    //Display the map when users enters address and press next button
                    console.log("true");

                    displayMap();
                    k.removeClass("nomap");
                } else if (id == "phase6") {
                    $("#setup-container").submit();
                } else {
                    var nextid = parseInt(id.substr(-1)) + 1;
                    if (nextid == 6) {
                        $("#setup-box-next").val("Submit");

                    }
                    var currSwitchBtn = $("input[for='" + id + "']");
                    var nextSwitchBtn = $("input[for='phase" + nextid + "']");

                    currSwitchBtn.removeClass("activeBtn");
                    nextSwitchBtn.removeClass("hidden");
                    nextSwitchBtn.addClass("activeBtn");
                    k.removeClass("activePhase", 1000, "linear");
                    $("#phase" + nextid).addClass("activePhase");
                }


            }
        }
    );


    //    Bottom switch phase button events

    $(".switch-btns").click(function(){
        $(".activePhase").removeClass("activePhase");
        $(".switch-btns").removeClass("activeBtn");
        $(this).addClass("activeBtn");
        var switchto=$(this).attr("for");
        if(switchto=="phase7"){
            $("#setup-box-next").attr("type","submit");

            $("#setup-box-next").val("Submit");

        }else{
            $("#setup-box-next").val("Next");

        }
        $("#"+switchto).addClass("activePhase");
    });



    //    Sharing type event handler of phase2
    $("#sharingtypeinp").change(function(){
        var value=$("#sharingtypeinp").val();
        if(value.localeCompare("Entire Place")!=0){
            $(".prdiv").css("display","flex");
        }
    });


    //   // Images loading functions
    //    function readURL(input) {
    //  if (input.files && input.files[0]) {
    //
    //
    //    for(var i =0;i<input.files.length;i++) {
    //        var reader = new FileReader();
    //
    //        reader.onload = function(e) {
    //            $("#image-preview-box").append("<div class='preview-img''></div>")
    //        }
    //        reader.readAsDataURL(input.files[i]); // convert to base64 string
    //    }
    //  }
    // }

    // $("#imgInp").change(function() {
    //    console.log("32432");
    //  readURL(this);
    // });
</script>





